<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>E‑Commerce Admin Panel — Single File (Mock Backend)</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1320;--muted:#94a3b8;--accent:#06b6d4;--accent-2:#7c3aed}
    *{box-sizing:border-box;font-family:Inter,Segoe UI,Helvetica,Arial,sans-serif}
    body{margin:0;background:linear-gradient(180deg,#071028 0%, #07192a 100%);color:#e6eef6}
    .app{display:grid;grid-template-columns:260px 1fr;min-height:100vh}
    aside{padding:18px;background:rgba(255,255,255,0.03);border-right:1px solid rgba(255,255,255,0.03)}
    .brand{font-weight:700;letter-spacing:0.6px;margin-bottom:18px;display:flex;align-items:center}
    .brand .logo{width:40px;height:40px;border-radius:8px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:inline-flex;align-items:center;justify-content:center;margin-right:12px}
    nav a{display:block;padding:8px 10px;border-radius:8px;color:var(--muted);text-decoration:none;margin-bottom:6px}
    nav a.active{background:rgba(255,255,255,0.03);color:#fff}
    header{display:flex;justify-content:space-between;align-items:center;padding:18px;border-bottom:1px solid rgba(255,255,255,0.02);background:transparent}
    .search{display:flex;gap:8px;align-items:center}
    .search input{padding:8px 12px;border-radius:10px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.02);color:#dfe7f2}
    main{padding:18px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:16px;margin-bottom:16px;box-shadow:0 6px 18px rgba(2,6,23,0.6)}
    table{width:100%;border-collapse:collapse}
    table th,table td{padding:10px;text-align:left;border-bottom:1px dashed rgba(255,255,255,0.02);font-size:14px;color:var(--muted)}
    .btn{display:inline-block;padding:8px 12px;border-radius:8px;background:var(--accent);color:#042028;text-decoration:none;font-weight:600}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .form-row{display:flex;gap:10px;margin-bottom:10px}
    .form-row input,.form-row select,textarea{flex:1;padding:8px;border-radius:8px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.02);color:#e6eef6}
    .flex{display:flex;gap:12px;align-items:center}
    .small{font-size:12px;color:var(--muted)}
    .badge{background:rgba(255,255,255,0.02);padding:6px 8px;border-radius:999px;font-weight:600}
    .file-thumb{width:60px;height:60px;border-radius:8px;object-fit:cover;border:1px solid rgba(255,255,255,0.03)}
    /* responsive */
    @media (max-width:900px){.app{grid-template-columns:1fr}aside{display:flex;overflow:auto}}
  </style>
</head>
<body>
  <div class="app">
    <aside>
      <div class="brand"><div class="logo">A</div>AdminPanel</div>
      <nav id="nav">
        <a href="#" data-view="dashboard" class="active">Dashboard</a>
        <a href="#" data-view="products">Products</a>
        <a href="#" data-view="orders">Orders</a>
        <a href="#" data-view="customers">Customers</a>
        <a href="#" data-view="marketing">Marketing</a>
        <a href="#" data-view="analytics">Analytics</a>
        <a href="#" data-view="shipping">Shipping</a>
        <a href="#" data-view="payments">Payments</a>
        <a href="#" data-view="support">Support</a>
        <a href="#" data-view="settings">Settings</a>
      </nav>
      <div style="margin-top:18px" class="small">Local demo: data stored in browser localStorage. Use "Export Backup" to save a JSON snapshot.</div>
    </aside><section style="display:flex;flex-direction:column;min-height:100vh">
  <header>
    <div class="search">
      <input id="globalSearch" placeholder="Search products, orders, customers..." />
      <button class="btn ghost" id="importBtn">Import</button>
      <button class="btn" id="exportBtn">Export Backup</button>
    </div>
    <div class="flex">
      <div class="small">Signed in as <strong>Admin</strong></div>
    </div>
  </header>

  <main id="main">
    <!-- Views will be injected here -->
  </main>
</section>

  </div>  <template id="dashboardTpl">
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <h2 style="margin:0">Dashboard</h2>
          <div class="small">Overview of sales, orders, products and recent activity</div>
        </div>
        <div>
          <button class="btn" id="newProductFromDash">+ New Product</button>
        </div>
      </div>
    </div><div class="grid">
  <div class="card">
    <div class="small">Total Sales</div>
    <h3 id="statSales">0</h3>
    <div class="small">Period: All time</div>
  </div>
  <div class="card">
    <div class="small">Total Orders</div>
    <h3 id="statOrders">0</h3>
    <div class="small">Open / Fulfilled / Cancelled</div>
  </div>
  <div class="card">
    <div class="small">Total Products</div>
    <h3 id="statProducts">0</h3>
    <div class="small">Published / Draft</div>
  </div>
</div>

<div class="card">
  <h3 style="margin-top:0">Recent Orders</h3>
  <div id="recentOrders"></div>
</div>

  </template>  <template id="productsTpl">
    <div class="card" style="display:flex;justify-content:space-between;align-items:center">
      <div>
        <h2 style="margin:0">Products</h2>
        <div class="small">Manage catalog, inventory, pricing, images, variations</div>
      </div>
      <div class="flex">
        <input id="productFilter" placeholder="Filter by name or SKU" />
        <button class="btn" id="addProductBtn">+ Add Product</button>
        <button class="btn ghost" id="exportProductsCSV">Export CSV</button>
      </div>
    </div><div class="card">
  <table id="productsTable"><thead><tr><th>Image</th><th>Title / SKU</th><th>Price</th><th>Inventory</th><th>Status</th><th>Actions</th></tr></thead><tbody></tbody></table>
</div>

<!-- Product Form Modal (simple inline form) -->
<div class="card" id="productFormCard" style="display:none">
  <h3 id="productFormTitle">Add Product</h3>
  <div class="form-row">
    <input id="p_title" placeholder="Product title" />
    <input id="p_sku" placeholder="SKU" />
  </div>
  <div class="form-row">
    <input id="p_price" type="number" placeholder="Price" />
    <input id="p_inventory" type="number" placeholder="Inventory" />
  </div>
  <div style="margin-bottom:10px"><textarea id="p_description" rows="4" placeholder="Description"></textarea></div>
  <div class="form-row">
    <input id="p_variations" placeholder="Variations (comma separated, e.g. Size:S,M,L)" />
    <input id="p_tags" placeholder="Tags (comma separated)" />
  </div>
  <div class="form-row">
    <input type="file" id="p_image" accept="image/*" />
    <img id="p_image_preview" class="file-thumb" src="" alt="" />
  </div>
  <div class="flex" style="justify-content:flex-end;margin-top:8px">
    <button class="btn ghost" id="cancelProduct">Cancel</button>
    <button class="btn" id="saveProduct">Save Product</button>
  </div>
</div>

  </template>  <template id="ordersTpl">
    <div class="card" style="display:flex;justify-content:space-between;align-items:center">
      <div>
        <h2 style="margin:0">Orders</h2>
        <div class="small">View and manage orders, refunds, cancellations, tracking</div>
      </div>
      <div>
        <select id="orderFilterStatus"><option value="all">All</option><option>Pending</option><option>Processing</option><option>Fulfilled</option><option>Cancelled</option></select>
      </div>
    </div><div class="card">
  <table id="ordersTable"><thead><tr><th>Order #</th><th>Customer</th><th>Items</th><th>Total</th><th>Status</th><th>Actions</th></tr></thead><tbody></tbody></table>
</div>

  </template>  <template id="customersTpl">
    <div class="card" style="display:flex;justify-content:space-between;align-items:center">
      <div>
        <h2 style="margin:0">Customers</h2>
        <div class="small">Manage customer profiles, groups, roles and support</div>
      </div>
      <div>
        <input id="customerFilter" placeholder="Search customers" />
      </div>
    </div><div class="card">
  <table id="customersTable"><thead><tr><th>Name</th><th>Email</th><th>Orders</th><th>Groups</th><th>Actions</th></tr></thead><tbody></tbody></table>
</div>

  </template>  <template id="marketingTpl">
    <div class="card">
      <h2 style="margin:0">Marketing</h2>
      <div class="small">Coupons, promotions, loyalty, referral and email automation (mock)</div>
    </div>
    <div class="card">
      <h3>Coupons</h3>
      <div class="form-row"><input id="coupon_code" placeholder="Code e.g. SAVE10" /><input id="coupon_amount" placeholder="Amount (eg 10 or 15%)" /><select id="coupon_type"><option value="fixed">Fixed</option><option value="percent">Percent</option></select><button class="btn" id="createCoupon">Create</button></div>
      <table id="couponsTable"><thead><tr><th>Code</th><th>Type</th><th>Amount</th><th>Actions</th></tr></thead><tbody></tbody></table>
    </div>
  </template>  <template id="analyticsTpl">
    <div class="card"><h2 style="margin:0">Analytics</h2><div class="small">Sales, conversion and product performance</div></div>
    <div class="card"><canvas id="salesChart" width="800" height="240"></canvas></div>
    <div class="card"><h3>Top Products</h3><div id="topProductsList"></div></div>
  </template>  <template id="shippingTpl">
    <div class="card"><h2>Shipping</h2><div class="small">Shipping carriers, labels, rates and tracking</div></div>
    <div class="card"><h3>Mock Carrier Integration</h3><div class="small">Generate tracking numbers and estimate shipping costs</div>
      <div class="form-row"><input id="ship_order_id" placeholder="Order #" /><select id="ship_carrier"><option>FastShip</option><option>GlobalPost</option></select><button class="btn" id="createLabel">Generate Label</button></div>
      <div id="shipOutput" style="margin-top:8px" class="small"></div>
    </div>
  </template>  <template id="paymentsTpl">
    <div class="card"><h2>Payments</h2><div class="small">Payment gateways, transactions, tokenization & fraud detection (mock)</div></div>
    <div class="card"><h3>Transactions</h3><table id="transactionsTable"><thead><tr><th>Txn ID</th><th>Order</th><th>Amount</th><th>Status</th></tr></thead><tbody></tbody></table></div>
  </template>  <template id="supportTpl">
    <div class="card"><h2>Support</h2><div class="small">Ticketing system and customer service metrics (mock)</div></div>
    <div class="card"><h3>Tickets</h3><div id="ticketsList"></div></div>
  </template>  <template id="settingsTpl">
    <div class="card"><h2>Settings</h2><div class="small">System, store, taxes, shipping, payment and security settings</div></div>
    <div class="card">
      <h3>System</h3>
      <div class="form-row"><label class="small">Two-factor auth: <select id="setting_2fa"><option value="off">Off</option><option value="on">On</option></select></label>
      <div style="margin-left:auto"><button class="btn" id="exportSettings">Export Settings</button></div></div>
    </div>
  </template>  <script>
    /***** Simple in-browser "backend" using localStorage *****/
    const DB = {
      key: 'ecom_admin_demo_v1',
      load(){
        const raw = localStorage.getItem(this.key);
        return raw ? JSON.parse(raw) : this.reset();
      },
      save(state){ localStorage.setItem(this.key, JSON.stringify(state)); },
      reset(){
        const s = {products:[],orders:[],customers:[],coupons:[],transactions:[],tickets:[],settings:{2fa:false}}; this.save(s); return s;
      }
    };

    let state = DB.load();

    // Simple helpers
    const uid = (prefix='id')=> prefix+'_'+Math.random().toString(36).slice(2,9);
    const nav = document.getElementById('nav');
    const main = document.getElementById('main');
    const templates = {};
    document.querySelectorAll('template').forEach(t=>templates[t.id.replace('Tpl','')]=t);

    function renderView(view){
      // nav active
      document.querySelectorAll('#nav a').forEach(a=>a.classList.toggle('active', a.dataset.view===view));
      main.innerHTML = '';
      const tpl = templates[view];
      if(!tpl){ main.innerHTML='<div class="card"><h2>Not found</h2></div>'; return }
      main.appendChild(tpl.content.cloneNode(true));
      attachViewHandlers(view);
    }

    nav.addEventListener('click',e=>{ if(e.target.matches('a')){ e.preventDefault(); renderView(e.target.dataset.view); } });

    // Global import/export
    document.getElementById('exportBtn').addEventListener('click', ()=>{
      const blob = new Blob([JSON.stringify(state, null, 2)],{type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href=url; a.download='ecom-admin-backup.json'; a.click(); URL.revokeObjectURL(url);
    });
    document.getElementById('importBtn').addEventListener('click', ()=>{
      const f = document.createElement('input'); f.type='file'; f.accept='application/json'; f.onchange = ()=>{
        const r = new FileReader(); r.onload = ()=>{ try{ state = JSON.parse(r.result); DB.save(state); alert('Imported successfully. Reloading view.'); renderView('dashboard'); }catch(err){alert('Invalid file') } }; r.readAsText(f.files[0]);
      }; f.click();
    });

    // Initial render
    renderView('dashboard');

    function attachViewHandlers(view){
      if(view==='dashboard'){
        document.getElementById('statSales').textContent = state.transactions.reduce((s,t)=>s+ (t.amount||0),0);
        document.getElementById('statOrders').textContent = state.orders.length;
        document.getElementById('statProducts').textContent = state.products.length;
        const ro = document.getElementById('recentOrders'); ro.innerHTML='';
        state.orders.slice(-6).reverse().forEach(o=>{ const d = document.createElement('div'); d.className='small'; d.textContent = `#${o.id} — ${o.customer_name} — ${o.total} — ${o.status}`; ro.appendChild(d);} )
        document.getElementById('newProductFromDash').addEventListener('click', ()=>{ renderView('products'); setTimeout(()=>document.getElementById('addProductBtn').click(),50)});
      }

      if(view==='products'){
        const productsTable = document.querySelector('#productsTable tbody');
        const formCard = document.getElementById('productFormCard');
        let editingId = null;

        function refresh(){
          productsTable.innerHTML='';
          state.products.forEach(p=>{
            const tr = document.createElement('tr');
            tr.innerHTML = `
              <td><img src="${p.image||''}" class="file-thumb"/></td>
              <td><strong>${p.title}</strong><div class="small">${p.sku||''}</div></td>
              <td>${p.price||0}</td>
              <td>${p.inventory||0}</td>
              <td><span class="badge">${p.status||'active'}</span></td>
              <td><button class="btn ghost edit" data-id="${p.id}">Edit</button> <button class="btn ghost del" data-id="${p.id}">Delete</button></td>
            `;
            productsTable.appendChild(tr);
          });
        }
        refresh();

        document.getElementById('addProductBtn').addEventListener('click', ()=>{ editingId=null; formCard.style.display='block'; document.getElementById('productFormTitle').textContent='Add Product'; clearProductForm(); });
        document.getElementById('cancelProduct').addEventListener('click', ()=>{ formCard.style.display='none'; });

        function clearProductForm(){ document.getElementById('p_title').value=''; document.getElementById('p_sku').value=''; document.getElementById('p_price').value=''; document.getElementById('p_inventory').value='0'; document.getElementById('p_description').value=''; document.getElementById('p_variations').value=''; document.getElementById('p_tags').value=''; document.getElementById('p_image_preview').src=''; document.getElementById('p_image').value=''; }

        productsTable.addEventListener('click', e=>{
          if(e.target.matches('.del')){ const id=e.target.dataset.id; if(confirm('Delete product?')){ state.products = state.products.filter(p=>p.id!==id); DB.save(state); refresh(); } }
          if(e.target.matches('.edit')){ const id=e.target.dataset.id; editingId=id; const p = state.products.find(x=>x.id===id); formCard.style.display='block'; document.getElementById('productFormTitle').textContent='Edit Product'; document.getElementById('p_title').value=p.title; document.getElementById('p_sku').value=p.sku; document.getElementById('p_price').value=p.price; document.getElementById('p_inventory').value=p.inventory; document.getElementById('p_description').value=p.description; document.getElementById('p_variations').value=(p.variations||[]).join(','); document.getElementById('p_tags').value=(p.tags||[]).join(','); document.getElementById('p_image_preview').src=p.image||''; }
        });

        document.getElementById('p_image').addEventListener('change', e=>{
          const f = e.target.files[0]; if(!f) return; const r = new FileReader(); r.onload = ()=>{ document.getElementById('p_image_preview').src=r.result; }; r.readAsDataURL(f);
        });

        document.getElementById('saveProduct').addEventListener('click', ()=>{
          const p = { title:document.getElementById('p_title').value.trim(), sku:document.getElementById('p_sku').value.trim(), price:parseFloat(document.getElementById('p_price').value||0), inventory:parseInt(document.getElementById('p_inventory').value||0), description:document.getElementById('p_description').value, variations:document.getElementById('p_variations').value.split(',').map(s=>s.trim()).filter(Boolean), tags:document.getElementById('p_tags').value.split(',').map(s=>s.trim()).filter(Boolean), image:document.getElementById('p_image_preview').src, status:'active' };
          if(editingId){ p.id = editingId; state.products = state.products.map(x=> x.id===editingId? p : x); } else { p.id = uid('prod'); state.products.push(p); }
          DB.save(state); refresh(); formCard.style.display='none';
        });

        // Export CSV (basic)
        document.getElementById('exportProductsCSV').addEventListener('click', ()=>{
          const rows = [['id','title','sku','price','inventory','tags','variations']];
          state.products.forEach(p=> rows.push([p.id, p.title, p.sku, p.price, p.inventory, (p.tags||[]).join('|'), (p.variations||[]).join('|')]));
          const csv = rows.map(r=> r.map(c=> '"'+String(c||'').replace(/"/g,'""')+'"').join(',')).join('\n');
          const blob = new Blob([csv],{type:'text/csv'}); const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download='products.csv'; a.click(); URL.revokeObjectURL(url);
        });

        // Simple filter
        document.getElementById('productFilter').addEventListener('input', e=>{
          const q = e.target.value.toLowerCase(); document.querySelectorAll('#productsTable tbody tr').forEach(tr=>{
            tr.style.display = tr.textContent.toLowerCase().includes(q)? 'table-row':'none';
          });
        });

      }

      if(view==='orders'){
        const tb = document.querySelector('#ordersTable tbody');
        function refresh(){ tb.innerHTML=''; state.orders.forEach(o=>{
          const tr = document.createElement('tr'); tr.innerHTML = `<td>#${o.id}</td><td>${o.customer_name||o.customer_email||'Guest'}</td><td>${(o.items||[]).map(it=>it.title).join(', ')}</td><td>${o.total}</td><td>${o.status}</td><td><button class="btn ghost view" data-id="${o.id}">View</button></td>`; tb.appendChild(tr);
        }); }
        refresh();
        tb.addEventListener('click', e=>{ if(e.target.matches('.view')){ const id=e.target.dataset.id; const o = state.orders.find(x=>x.id===id); if(!o) return; const details = `Order #${o.id}\nCustomer: ${o.customer_name}\nTotal: ${o.total}\nStatus: ${o.status}`; if(confirm(details + '\n\nMark as Fulfilled?')){ o.status='Fulfilled'; DB.save(state); refresh(); alert('Order updated.'); } } });
        document.getElementById('orderFilterStatus').addEventListener('change', e=>{
          const v = e.target.value; document.querySelectorAll('#ordersTable tbody tr').forEach(tr=>{ tr.style.display = (v==='all'|| tr.children[4].textContent===v) ? 'table-row':'none'; });
        });
      }

      if(view==='customers'){
        const tb = document.querySelector('#customersTable tbody');
        function refresh(){ tb.innerHTML=''; state.customers.forEach(c=>{ const tr = document.createElement('tr'); tr.innerHTML = `<td>${c.name}</td><td>${c.email}</td><td>${(c.orders||[]).length}</td><td>${(c.groups||[]).join(', ')}</td><td><button class="btn ghost view" data-id="${c.id}">View</button></td>`; tb.appendChild(tr); }); }
        refresh();
        document.getElementById('customerFilter').addEventListener('input', e=>{ const q=e.target.value.toLowerCase(); document.querySelectorAll('#customersTable tbody tr').forEach(tr=>{ tr.style.display = tr.textContent.toLowerCase().includes(q)?'table-row':'none'; }); });
      }

      if(view==='marketing'){
        const tb = document.querySelector('#couponsTable tbody'); function refresh(){ tb.innerHTML=''; state.coupons.forEach(c=>{ const tr=document.createElement('tr'); tr.innerHTML = `<td>${c.code}</td><td>${c.type}</td><td>${c.amount}</td><td><button class="btn ghost del" data-id="${c.id}">Delete</button></td>`; tb.appendChild(tr); }); }
        refresh(); document.getElementById('createCoupon').addEventListener('click', ()=>{ const code=document.getElementById('coupon_code').value.trim(); const amount=document.getElementById('coupon_amount').value.trim(); const type=document.getElementById('coupon_type').value; if(!code) return alert('Enter code'); state.coupons.push({id:uid('coup'),code,amount,type}); DB.save(state); refresh(); });
        tb.addEventListener('click', e=>{ if(e.target.matches('.del')){ const id=e.target.dataset.id; state.coupons = state.coupons.filter(x=>x.id!==id); DB.save(state); refresh(); } });
      }

      if(view==='analytics'){
        const canvas = document.getElementById('salesChart'); const ctx = canvas.getContext('2d'); ctx.clearRect(0,0,canvas.width,canvas.height);
        // crude monthly totals from orders by createdAt
        const months = {}; state.orders.forEach(o=>{ const m = (o.createdAt && new Date(o.createdAt).toISOString().slice(0,7)) || 'unknown'; months[m]=(months[m]||0)+ (o.total||0); });
        const labels = Object.keys(months).slice(-12); const values = labels.map(l=>months[l]||0);
        // draw simple bar chart
        const pad=40; const w=canvas.width-pad*2; const h=canvas.height-pad*2; const bw = w/Math.max(1,labels.length); const maxV = Math.max(...values,1);
        // axes
        ctx.strokeStyle='rgba(255,255,255,0.06)'; ctx.beginPath(); ctx.moveTo(pad, pad); ctx.lineTo(pad, pad+h); ctx.lineTo(pad+w, pad+h); ctx.stroke();
        values.forEach((v,i)=>{ const x = pad + i*bw + 6; const barH = (v/maxV)* (h-20); ctx.fillStyle='rgba(6,182,212,0.9)'; ctx.fillRect(x, pad + h - barH - 2, bw-12, barH); ctx.fillStyle='rgba(255,255,255,0.6)'; ctx.fillText(labels[i], x, pad+h+12); });
        // top products
        const top = {}; state.orders.forEach(o=> (o.items||[]).forEach(it=> top[it.id]=(top[it.id]||0)+ (it.qty||1)) );
        const arr = Object.entries(top).sort((a,b)=>b[1]-a[1]).slice(0,6);
        const list = document.getElementById('topProductsList'); list.innerHTML=''; arr.forEach(([id,c])=>{ const p = state.products.find(x=>x.id===id); const div = document.createElement('div'); div.className='small'; div.textContent = `${p? p.title : id} — ${c} sold`; list.appendChild(div); });
      }

      if(view==='shipping'){
        document.getElementById('createLabel').addEventListener('click', ()=>{
          const orderId = document.getElementById('ship_order_id').value.trim(); const carrier = document.getElementById('ship_carrier').value; if(!orderId) return alert('Enter order #'); const tracking = carrier.slice(0,3).toUpperCase()+Math.floor(Math.random()*900000+100000);
          document.getElementById('shipOutput').textContent = `Label created — Carrier: ${carrier} — Tracking: ${tracking}`;
          const o = state.orders.find(x=>x.id===orderId); if(o){ o.tracking = tracking; o.carrier = carrier; DB.save(state); }
        });
      }

      if(view==='payments'){
        const tb=document.querySelector('#transactionsTable tbody'); tb.innerHTML=''; state.transactions.forEach(t=>{ const tr=document.createElement('tr'); tr.innerHTML=`<td>${t.id}</td><td>${t.orderId}</td><td>${t.amount}</td><td>${t.status}</td>`; tb.appendChild(tr); });
      }

      if(view==='support'){
        const out = document.getElementById('ticketsList'); out.innerHTML=''; state.tickets.forEach(t=>{ const d=document.createElement('div'); d.className='small'; d.textContent = `#${t.id} — ${t.subject} — ${t.status}`; out.appendChild(d); });
      }

      if(view==='settings'){
        document.getElementById('setting_2fa').value = state.settings && state.settings['2fa'] ? 'on':'off';
        document.getElementById('exportSettings').addEventListener('click', ()=>{ const blob = new Blob([JSON.stringify(state.settings||{},null,2)],{type:'application/json'}); const url = URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='settings.json'; a.click(); URL.revokeObjectURL(url); });
        document.getElementById('setting_2fa').addEventListener('change', e=>{ state.settings['2fa'] = e.target.value==='on'; DB.save(state); alert('Setting saved'); });
      }

    }

    // seed some demo data if empty
    if(state.products.length===0 && state.orders.length===0 && state.customers.length===0){
      const p1 = {id:uid('prod'), title:'Colombian Coffee Beans 250g', sku:'COF-250', price:9.99, inventory:120, description:'Single origin', variations:['250g','500g'], tags:['coffee','beans'], image:'', status:'active'};
      const p2 = {id:uid('prod'), title:'Handmade Ceramic Mug', sku:'MUG-01', price:14.5, inventory:50, description:'350ml mug', variations:[], tags:['mug','kitchen'], image:'', status:'active'};
      const c1 = {id:uid('cus'), name:'Jane Doe', email:'jane@example.com', orders:[]};
      const o1 = {id:uid('ord'), customer_id:c1.id, customer_name:c1.name, items:[{id:p1.id,title:p1.title,qty:2,price:p1.price}], total:19.98, status:'Pending', createdAt:new Date().toISOString()};
      state.products.push(p1,p2); state.customers.push(c1); state.orders.push(o1); state.transactions.push({id:uid('txn'), orderId:o1.id, amount:o1.total, status:'Paid'}); DB.save(state);
    }

    // quick keyboard shortcut: g then letter to go to view (g p -> products)
    let gMode=false; window.addEventListener('keydown', e=>{ if(e.key==='g'){ gMode=true; setTimeout(()=>gMode=false,1200); } else if(gMode){ const map = {d:'dashboard',p:'products',o:'orders',c:'customers',m:'marketing',a:'analytics',s:'settings'}; if(map[e.key]){ renderView(map[e.key]); gMode=false; } } });

  </script></body>
</html>